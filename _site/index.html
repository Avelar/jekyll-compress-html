<!doctype html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compress HTML in Jekyll</title><link rel="stylesheet" href="/ui/app.css"><link rel="icon" href="/ui/img/favicon-1.png"><body><div class="row"><div class="medium-10 medium-offset-2 large-8 large-offset-4 columns"><h1>Compress HTML in Jekyll</h1><p>A <a href="http://jekyllrb.com/">Jekyll</a> layout that compresses <a href="https://html.spec.whatwg.org/">HTML</a>. At a glance:<ul><li>removes unnecessary whitespace;<li>removes optional end tags;<li>removes comments;<li>preserves whitespace within <code>&lt;pre&gt;</code>;<li>GitHub Pages compatible;<li>ignores development environments;<li>configurable affected elements;<li>automatically tested.</ul><p>The layout is written in pure <a href="http://docs.shopify.com/themes/liquid-documentation/basics">Liquid</a>, no plugins are required.<p>The main reason for the compression is to <a href="http://css-tricks.com/fighting-the-space-between-inline-block-elements/">fight the space between inline block elements</a>. File size reduction is a welcome gain.<h2 id="results">Results</h2><p>All options activated. File sizes in bytes. As of June 2014.<table><thead><tr><th style="text-align: left">Site<th style="text-align: right">Original<th style="text-align: right">Compressed<tbody><tr><td style="text-align: left"><a href="http://getbootstrap.com/css/">Bootstrap CSS</a><td style="text-align: right">249762<td style="text-align: right">232085<tr><td style="text-align: left"><a href="http://iiif.io/api/image/2.0/">IIIF Image</a><td style="text-align: right">61150<td style="text-align: right">52732<tr><td style="text-align: left"><a href="http://jekyllrb.com/news/">Jekyll News</a><td style="text-align: right">45358<td style="text-align: right">40251<tr><td style="text-align: left"><a href="http://motherfuckingwebsite.com/">Mother­fucking</a><td style="text-align: right">5200<td style="text-align: right">4519<tr><td style="text-align: left"><a href="http://calendar.perfplanet.com/2012/creating-a-performance-culture/">Performance Culture</a><td style="text-align: right">20715<td style="text-align: right">19986</table><h2 id="installation">Installation</h2><ol><li>Get the <a href="https://github.com/penibelst/jekyll-compress-html/releases/latest">latest release</a>. Extract <code>compress.html</code> and copy it to your <code>_layouts</code>.<li>Reference the <code>compress</code> layout in your highest-level layout. For example in <code>_layouts/default.html</code>:</ol><pre><code class="language-html">---
layout: compress
---

&lt;html&gt;
{{ content }}
&lt;/html&gt;
</code></pre><p>Now all your markup will be processed by the <code>compress</code> layout.<h2 id="configuration">Configuration</h2><p>By default the layout replaces contiguous whitespace with a single whitespace character. Additional settings can be specified in the <code>compress_html</code> key inside the <code>_config.yml</code> file:<pre><code class="language-yaml">compress_html:
  clippings: []
  comments: []
  endings: []
  ignore:
    envs: []
</code></pre><h3 id="clippings">clippings</h3><p>An array of elements to clip whitespace around them. The following elements may be safe to clip:<ul><li><a href="https://html.spec.whatwg.org/multipage/semantics.html">Metadata content</a>;<li><a href="https://html.spec.whatwg.org/multipage/semantics.html">Sections</a>;<li><a href="https://html.spec.whatwg.org/multipage/semantics.html">Grouping content</a> except the <code>pre</code> element;<li><a href="https://html.spec.whatwg.org/multipage/tables.html">Tabular data</a>.</ul><p>Example:<pre><code class="language-yaml">compress_html:
  clippings: [div, p, ul, td, h1, h2]
</code></pre><p>Use the shortcut <code>all</code> to clip all safe elements.<pre><code class="language-yaml">compress_html:
  clippings: all
</code></pre><h3 id="comments">comments</h3><p>An array of exactly two comment tags to strip comments enclosed by them. The first string must be the start tag, the second must be the end tag. Example:<pre><code class="language-yaml">compress_html:
  comments: ["&lt;!-- ", " --&gt;"]
</code></pre><p>Whitespaces around the tags prevent <a href="http://msdn.microsoft.com/en-us/library/ms537512.aspx">conditional comments</a> from being deleted.<h3 id="endings">endings</h3><p>An array of elements with <a href="https://html.spec.whatwg.org/multipage/syntax.html">optional end tags</a>. These end tags will be removed.<p>Example:<pre><code class="language-yaml">compress_html:
  endings: [p, li, td]
</code></pre><p>Use the shortcut <code>all</code> to remove all optional endings.<pre><code class="language-yaml">compress_html:
  endings: all
</code></pre><h3 id="ignoreenvs">ignore.envs</h3><p>An array of environments given by <code>ENV["JEKYLL_ENV"]</code> where the compress layout is ignored. This may be useful while developing a website.<h3 id="full-blown-sample">Full-blown sample</h3><pre><code class="language-yaml">compress_html:
  clippings: all
  comments: ["&lt;!-- ", " --&gt;"]
  endings: all
  ignore:
    envs: [development]
</code></pre><h2 id="restrictions">Restrictions</h2><ul><li>Whitespaces inside of the <code>textarea</code> element are squeezed. Please don’t use the layout on pages with non-empty <code>textarea</code>.<li>Inline JS can become broken where <code>//</code> comments used. Please remove the comments or change to <code>/**/</code> style.<li>Invalid markup can lead to unexpected results. Please make sure your markup is valid before.</ul><h2 id="examples">Examples</h2><p>This page itself is compressed by the layout. It’s hosted by GitHub in the <code>gh-pages</code> <a href="https://github.com/penibelst/jekyll-compress-html/tree/gh-pages">branch</a>.<p>Look how <a href="https://github.com/search?l=html&amp;o=desc&amp;q=jekyll-compress-html+path%3A_layouts&amp;s=indexed&amp;type=Code">others use</a> the layout on GitHub too.<h2 id="development">Development</h2><p><a href="https://travis-ci.org/penibelst/jekyll-compress-html"><img src="https://api.travis-ci.org/penibelst/jekyll-compress-html.svg?branch=master" alt="Build Status" class="status" /></a><p>Feel free to submit bugs, patches, and questions in the <a href="https://github.com/penibelst/jekyll-compress-html">repository</a>.<p>Take a look at project’s <code>test/source</code> and <code>test/expected</code> directories. They contain self-explanatory specifications. Run <code>rake</code> to test the layout.<hr /><p>© 2014–2015 <a href="http://penibelst.de/">Anatol Broder</a>. Licensed under the MIT License.</div></div>
